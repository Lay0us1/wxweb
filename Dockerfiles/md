FROM nginx:latest
LABEL maintainer="xrsec"
LABEL mail="troy@zygd.site"
LABEL Github="https://github.com/XRSec/wxweb"
LABEL org.opencontainers.image.source="https://github.com/XRSec/wxweb"
LABEL org.opencontainers.image.title="wxweb"

ADD md.tar.gz /tmp/www

# https://github.com/doocs/md.git
RUN apt-get -qq update \
    && apt-get -qq upgrade \
    && apt-get -qq install sudo \
    && curl -fsSL https://deb.nodesource.com/setup_16.x | sudo -E bash - \
    && apt-get -qq install git nodejs \
    && cd /tmp/www \
    && ls \
    && npm i \
    && npm run build:h5-netlify \
    && cp -rf /tmp/www/dist/* /usr/share/nginx/html/ \
    && rm -rf /tmp/www

ENV LANG en_US.utf8